(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))u(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&u(r)}).observe(document,{childList:!0,subtree:!0});function f(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function u(e){if(e.ep)return;e.ep=!0;const o=f(e);fetch(e.href,o)}})();var E={exports:{}};(function(i,n){n=i.exports=f,n.getSerialize=u;function f(e,o,r,l){return JSON.stringify(e,u(o,l),r)}function u(e,o){var r=[],l=[];return o==null&&(o=function(g,m){return r[0]===m?"[Circular ~]":"[Circular ~."+l.slice(0,r.indexOf(m)).join(".")+"]"}),function(g,m){if(r.length>0){var s=r.indexOf(this);~s?r.splice(s+1):r.push(this),~s?l.splice(s,1/0,g):l.push(g),~r.indexOf(m)&&(m=o.call(this,g,m))}else r.push(m);return e==null?m:e.call(this,g,m)}}})(E,E.exports);var O=E.exports,b=O,D=function(){var i=4022871197,n=function(f){if(f){f=f.toString();for(var u=0;u<f.length;u++){i+=f.charCodeAt(u);var e=.02519603282416938*i;i=e>>>0,e-=i,e*=i,i=e>>>0,e-=i,i+=e*4294967296}return(i>>>0)*23283064365386963e-26}else i=4022871197};return n},h=function(i){return function(){var n=48,f=1,u=n,e=new Array(n),o,r,l=0,g=new D;for(o=0;o<n;o++)e[o]=g(Math.random());var m=function(){++u>=n&&(u=0);var t=1768863*e[u]+f*23283064365386963e-26;return e[u]=t-(f=t|0)},s=function(t){return Math.floor(t*(m()+(m()*2097152|0)*11102230246251565e-32))};s.string=function(t){var a,y="";for(a=0;a<t;a++)y+=String.fromCharCode(33+s(94));return y};var c=function(){var t=Array.prototype.slice.call(arguments);for(o=0;o<t.length;o++)for(r=0;r<n;r++)e[r]-=g(t[o]),e[r]<0&&(e[r]+=1)};return s.cleanString=function(t){return t=t.replace(/(^\s*)|(\s*$)/gi,""),t=t.replace(/[\x00-\x1F]/gi,""),t=t.replace(/\n /,`
`),t},s.hashString=function(t){for(t=s.cleanString(t),g(t),o=0;o<t.length;o++)for(l=t.charCodeAt(o),r=0;r<n;r++)e[r]-=g(l),e[r]<0&&(e[r]+=1)},s.seed=function(t){(typeof t>"u"||t===null)&&(t=Math.random()),typeof t!="string"&&(t=b(t,function(a,y){return typeof y=="function"?y.toString():y})),s.initState(),s.hashString(t)},s.addEntropy=function(){var t=[];for(o=0;o<arguments.length;o++)t.push(arguments[o]);c(l+++new Date().getTime()+t.join("")+Math.random())},s.initState=function(){for(g(),o=0;o<n;o++)e[o]=g(" ");f=1,u=n},s.done=function(){g=null},typeof i<"u"&&s.seed(i),s.range=function(t){return s(t)},s.random=function(){return s(Number.MAX_VALUE-1)/Number.MAX_VALUE},s.floatBetween=function(t,a){return s.random()*(a-t)+t},s.intBetween=function(t,a){return Math.floor(s.random()*(a-t+1))+t},s}()};h.create=function(i){return new h(i)};var U=h;const p=8,j=4,v=j<<1,d=p+v;function x(i,n){const f=new Array(i);for(let e=0;e<i;e++)f[e]=e;const u=U.create(n);for(let e=i-1;e;e--){const o=u(e),r=f[e];f[e]=f[o],f[o]=r}return f}function I(i,n,f,u){n[u]=i[f],n[u+1]=i[f+1],n[u+2]=i[f+2],n[u+3]=i[f+3]}function C({data:i,width:n,height:f},u){const e=Math.ceil(n/p)-2,o=n-e*p,r=Math.floor(o/2),l=e*d+v+o,g=new Uint8ClampedArray(l*f*4),m=x(e,u),s=(c,t)=>I(i,g,c,t);for(let c=0;c<f;c++){for(let t=0;t<r;t++)s(c*n+t<<2,c*l+t<<2);{const t=c*n+r-1<<2;for(let a=0;a<j;a++)s(t,c*l+r+a<<2)}for(let t=0;t<e;t++){{const a=c*n+r+t*p<<2;for(let y=0;y<j;y++)s(a,c*l+r+m[t]*d+j+y<<2)}for(let a=0;a<p;a++)s(c*n+r+t*p+a<<2,c*l+r+m[t]*d+v+a<<2);{const a=c*n+r+t*p+p-1<<2;for(let y=0;y<j;y++)s(a,c*l+r+m[t]*d+p+v+y<<2)}}{const t=c*n+r+e*p<<2;for(let a=0;a<j;a++)s(t,c*l+r+e*d+j+a<<2)}for(let t=r;t<o;t++)s(c*n+e*p+t<<2,c*l+e*d+v+t<<2)}return new ImageData(g,l,f)}function N({data:i,width:n,height:f},u){const e=Math.ceil(f/p)-2,o=f-e*p,r=Math.floor(o/2),l=e*d+v+o,g=new Uint8ClampedArray(n*l*4),m=x(e,u),s=(c,t)=>I(i,g,c,t);for(let c=0;c<n;c++){for(let t=0;t<r;t++)s(t*n+c<<2,t*n+c<<2);{const t=(r-1)*n+c<<2;for(let a=0;a<j;a++)s(t,(r+a)*n+c<<2)}for(let t=0;t<e;t++){{const a=(r+t*p)*n+c<<2;for(let y=0;y<j;y++)s(a,(r+m[t]*d+j+y)*n+c<<2)}for(let a=0;a<p;a++)s((r+t*p+a)*n+c<<2,(r+m[t]*d+v+a)*n+c<<2);{const a=(r+t*p+p-1)*n+c<<2;for(let y=0;y<j;y++)s(a,(r+m[t]*d+p+v+y)*n+c<<2)}}{const t=(r+e*p)*n+c<<2;for(let a=0;a<j;a++)s(t,(r+e*d+j+a)*n+c<<2)}for(let t=r;t<o;t++)s((e*p+t)*n+c<<2,(e*d+v+t)*n+c<<2)}return new ImageData(g,n,l)}function _({data:i,width:n,height:f},u){const e=Math.ceil(n/d)-2,o=n-e*d-v,r=Math.floor(o/2),l=e*p+o,g=new Uint8ClampedArray(l*f*4),m=x(e,u),s=(c,t)=>I(i,g,c,t);for(let c=0;c<f;c++){for(let t=0;t<r;t++)s(c*n+t<<2,c*l+t<<2);for(let t=0;t<e;t++)for(let a=0;a<p;a++)s(c*n+r+m[t]*d+v+a<<2,c*l+r+t*p+a<<2);for(let t=r;t<o;t++)s(c*n+e*d+v+t<<2,c*l+e*p+t<<2)}return new ImageData(g,l,f)}function S({data:i,width:n,height:f},u){const e=Math.ceil(f/d)-2,o=f-e*d-v,r=Math.floor(o/2),l=e*p+o,g=new Uint8ClampedArray(n*l*4),m=x(e,u),s=(c,t)=>I(i,g,c,t);for(let c=0;c<n;c++){for(let t=0;t<r;t++)s(t*n+c<<2,t*n+c<<2);for(let t=0;t<e;t++)for(let a=0;a<p;a++)s((r+m[t]*d+v+a)*n+c<<2,(r+t*p+a)*n+c<<2);for(let t=r;t<o;t++)s((e*d+v+t)*n+c<<2,(e*p+t)*n+c<<2)}return new ImageData(g,n,l)}function B(i,n){return N(C(i,n),n)}function T(i,n){return _(S(i,n),n)}document.querySelector("#app").innerHTML=`
    <h1>
        图片臊子3
    </h1>
    <div>
        <label>
            密码：
            <input id="password"/>
        </label>
    </div>
    <div>
        <label>
            加密：
            <input id="encrypt" type="file" accept="image/*"/>
        </label>
    </div>
    <div>
        <label>
            解密：
            <input id="decrypt" type="file" accept="image/*"/>
        </label>
    </div>
`;async function M(i){const n=URL.createObjectURL(i),f=document.createElement("img");await new Promise((l,g)=>{f.onload=()=>{URL.revokeObjectURL(n),l()},f.onabort=()=>{URL.revokeObjectURL(n),g(new Error("图片解析失败"))},f.src=n});const u=document.createElement("canvas"),{width:e,height:o}=f;u.width=e,u.height=o;const r=u.getContext("2d");return r.drawImage(f,0,0,e,o),r.getImageData(0,0,e,o)}function A(i,{name:n}){const f=document.createElement("canvas"),{width:u,height:e}=i;f.width=u,f.height=e,f.getContext("2d").putImageData(i,0,0);const r=f.toDataURL(),l=document.createElement("a");l.href=r,l.download=`${n}.png`,l.click()}const L=document.getElementById("password");document.getElementById("encrypt").onchange=async i=>{const n=i.target.files[0];A(B(await M(n),L.value),n)};document.getElementById("decrypt").onchange=async i=>{const n=i.target.files[0];A(T(await M(n),L.value),n)};
